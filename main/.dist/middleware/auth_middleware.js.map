{"version":3,"file":"auth_middleware.js","sourceRoot":"","sources":["../../middleware/auth_middleware.ts"],"names":[],"mappings":";;;AAAA,iEAAsD;AACtD,6DAA8D;AAE9D,SAAgB,QAAQ,CAAC,GAAG,EAAE,GAAG,EAAE,IAAI;IACnC,IAAI;QACA,MAAM,WAAW,GAAG,GAAG,CAAC,OAAO,CAAC,aAAa,CAAC;QAC9C,IAAG,CAAC,WAAW;YACX,OAAO,IAAI,CAAC,yBAAQ,CAAC,iBAAiB,EAAE,CAAC,CAAC;QAE9C,MAAM,YAAY,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;QAC/C,IAAG,CAAC,YAAY;YACZ,OAAO,IAAI,CAAC,yBAAQ,CAAC,iBAAiB,EAAE,CAAC,CAAC;QAE9C,MAAM,SAAS,GAAG,IAAA,mCAAmB,EAAC,YAAY,CAAC,CAAC;QACpD,IAAG,CAAC,SAAS;YACT,OAAO,IAAI,CAAC,yBAAQ,CAAC,iBAAiB,EAAE,CAAC,CAAC;QAE9C,GAAG,CAAC,IAAI,GAAG,SAAS,CAAC;QACrB,IAAI,EAAE,CAAC;KACV;IAAC,OAAO,CAAC,EAAE;QACR,OAAO,IAAI,CAAC,yBAAQ,CAAC,iBAAiB,EAAE,CAAC,CAAC;KAC7C;AACL,CAAC;AAnBD,4BAmBC","sourcesContent":["import {ApiError} from \"../exteptions/api_exceptions\";\nimport {validateAccessToken} from \"../services/token_service\";\n\nexport function passport(req, res, next) {\n    try {\n        const auth_header = req.headers.authorization;\n        if(!auth_header)\n            return next(ApiError.unauthorizedError());\n\n        const access_token = auth_header.split(' ')[1];\n        if(!access_token)\n            return next(ApiError.unauthorizedError());\n\n        const user_data = validateAccessToken(access_token);\n        if(!user_data)\n            return next(ApiError.unauthorizedError());\n\n        req.user = user_data;\n        next();\n    } catch (e) {\n        return next(ApiError.unauthorizedError());\n    }\n}"]}