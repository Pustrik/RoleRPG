{"version":3,"file":"passport.js","sourceRoot":"","sources":["../../middleware/passport.ts"],"names":[],"mappings":";;;;;AAAA,kFAAoD;AACpD,6DAA8D;AAE9D,SAAS,QAAQ,CAAC,GAAG,EAAE,GAAG,EAAE,IAAI;IAC5B,IAAI;QACA,MAAM,WAAW,GAAG,GAAG,CAAC,OAAO,CAAC,aAAa,CAAC;QAC9C,IAAG,CAAC,WAAW;YACX,OAAO,IAAI,CAAC,wBAAQ,CAAC,iBAAiB,EAAE,CAAC,CAAC;QAE9C,MAAM,YAAY,GAAG,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;QAC/C,IAAG,CAAC,YAAY;YACZ,OAAO,IAAI,CAAC,wBAAQ,CAAC,iBAAiB,EAAE,CAAC,CAAC;QAE9C,MAAM,SAAS,GAAG,IAAA,mCAAmB,EAAC,YAAY,CAAC,CAAC;QACpD,IAAG,CAAC,SAAS;YACT,OAAO,IAAI,CAAC,wBAAQ,CAAC,iBAAiB,EAAE,CAAC,CAAC;QAE9C,GAAG,CAAC,IAAI,GAAG,SAAS,CAAC;QACrB,IAAI,EAAE,CAAC;KACV;IAAC,OAAO,CAAC,EAAE;QACR,OAAO,IAAI,CAAC,wBAAQ,CAAC,iBAAiB,EAAE,CAAC,CAAC;KAC7C;AACL,CAAC;AACD,kBAAe,QAAQ,CAAC","sourcesContent":["import ApiError from \"../exteptions/api_exceptions\";\nimport {validateAccessToken} from \"../services/token_service\";\n\nfunction passport(req, res, next) {\n    try {\n        const auth_header = req.headers.authorization;\n        if(!auth_header)\n            return next(ApiError.unauthorizedError());\n\n        const access_token = auth_header.split(' ')[1];\n        if(!access_token)\n            return next(ApiError.unauthorizedError());\n\n        const user_data = validateAccessToken(access_token);\n        if(!user_data)\n            return next(ApiError.unauthorizedError());\n\n        req.user = user_data;\n        next();\n    } catch (e) {\n        return next(ApiError.unauthorizedError());\n    }\n}\nexport default passport;"]}